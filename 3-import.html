<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Importing Data – Biodiverse Quick Start Guide</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./4-visualise.html" rel="next">
<link href="./2-starting.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./3-import.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Importing Data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Biodiverse Quick Start Guide</a> 
        <div class="sidebar-tools-main">
    <a href="./Biodiverse-Quick-Start-Guide.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title"><strong>Quick Start Guide</strong></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Overview</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2-starting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Starting Biodiverse</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3-import.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Importing Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4-visualise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Visualising</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5-data-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6-export.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Export</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7-summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8-acknowledgements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Acknowledgements</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#3.1-data-structures" id="toc-3.1-data-structures" class="nav-link active" data-scroll-target="#3.1-data-structures"><span class="header-section-number">5.1</span> <strong>3.1 Data structures</strong></a></li>
  <li><a href="#3.2-opening-data" id="toc-3.2-opening-data" class="nav-link" data-scroll-target="#3.2-opening-data"><span class="header-section-number">5.2</span> <strong>3.2 Opening data</strong></a></li>
  <li><a href="#3.3-importing-data" id="toc-3.3-importing-data" class="nav-link" data-scroll-target="#3.3-importing-data"><span class="header-section-number">5.3</span> <strong>3.3 Importing data</strong></a>
  <ul class="collapse">
  <li><a href="#3.3.1-basedata" id="toc-3.3.1-basedata" class="nav-link" data-scroll-target="#3.3.1-basedata"><span class="header-section-number">5.3.1</span> <strong>3.3.1 BaseData</strong></a></li>
  <li><a href="#3.3.2-matrices" id="toc-3.3.2-matrices" class="nav-link" data-scroll-target="#3.3.2-matrices"><span class="header-section-number">5.3.2</span> <strong>3.3.2 Matrices</strong></a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"><span class="header-section-number">5.3.3</span> </a></li>
  <li><a href="#3.3.3-trees" id="toc-3.3.3-trees" class="nav-link" data-scroll-target="#3.3.3-trees"><span class="header-section-number">5.3.4</span> <strong>3.3.3 Trees</strong></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Importing Data</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<ol start="3" type="1">
<li><h1 id="open-or-import-data" data-number="5"><span class="header-section-number">5</span> <strong>Open or import data</strong></h1></li>
</ol>
<p>Note: If all your files are in the same location then you can set the working directory under the File menu to save time finding them. You can also bookmark folders in the file selector to get back to them more easily. Right click on a folder to see the option.</p>
<section id="3.1-data-structures" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="3.1-data-structures"><span class="header-section-number">5.1</span> <strong>3.1 Data structures</strong></h2>
<p>Before importing data it is important to understand the sorts of data supported by Biodiverse. There are four main types, each of which can be stored in native Biodiverse format[^1].</p>
<p><a href="https://github.com/shawnlaffan/biodiverse/wiki/DataStructures#projects"><strong>Projects</strong></a> – (file extension <strong>.bps</strong>) are a composite structure and may consist of a set of any number of BaseData, Tree and Matrix objects and any associated analysis results. These are only used by the GUI.</p>
<p><a href="https://github.com/shawnlaffan/biodiverse/wiki/DataStructures#basedata"><strong>BaseData</strong></a> – (file extension <strong>.bds</strong>) is the primary storage object used in Biodiverse. BaseData stores your spatial data (e.g.&nbsp;different species and their XY locations), a set of analysis parameters, and any associated outputs from cluster, moving window and/or randomisation analyses.</p>
<p><a href="https://github.com/shawnlaffan/biodiverse/wiki/DataStructures#trees"><strong>Trees</strong></a> – (file extension <strong>.bts</strong>) these are hierarchical tree structures, e.g.&nbsp;phylogenies, taxonomies or word roots, which are imported from nexus and similar formats. These are used for analyses involving tree structures, e.g.&nbsp;phylogenetic diversity, linked by the matching labels in a BaseData.</p>
<p><a href="https://github.com/shawnlaffan/biodiverse/wiki/DataStructures#matrices"><strong>Matrices</strong></a> – (file extension <strong>.bms</strong>) these are matrices of numeric values representing some relationship between pairs of labels or groups. These are used for analyses involving matrix structures linked by the matching labels in a BaseData. They are also used as part of cluster analyses, in which case they relate to pairs of groups in a BaseData object.</p>
</section>
<section id="3.2-opening-data" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="3.2-opening-data"><span class="header-section-number">5.2</span> <strong>3.2 Opening data</strong></h2>
<p>To open pre-existing data (i.e.&nbsp;a Project, BaseData, Matrix or Tree saved to disk), select <em>Open</em> under the desired menu option and then navigate to the relevant file to load it:</p>
<p>![][image4]<br>
Or click ![][image5] on the relevant menu bar.</p>
<p>Select the file you want to load, and click OK.</p>
</section>
<section id="3.3-importing-data" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="3.3-importing-data"><span class="header-section-number">5.3</span> <strong>3.3 Importing data</strong></h2>
<p>BaseData, Matrix, and Tree object data can be imported from ‘raw’ data files (e.g.&nbsp;Tabular text, rasters, shapefiles, spreadsheets or CSV text files in the case of BaseData and Matrix objects) by clicking on their respective import buttons ![][image6] on the main toolbar, or via the ‘Import’ command in their respective menus.</p>
<p>For BaseData objects, either a new object can be created, or an existing object can be added to. When adding data it is up to the user to ensure the new data are in the same coordinate system (i.e.&nbsp;Biodiverse does not check if you add data in UTM coordinates to a BaseData object using decimal degrees).</p>
<section id="3.3.1-basedata" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="3.3.1-basedata"><span class="header-section-number">5.3.1</span> <strong>3.3.1 BaseData</strong></h3>
<p>The default import file type for BaseData is delimited text (e.g.&nbsp;CSV files).</p>
<p>These instructions describe the process where an input text file is in list format and contains one record per observation, with separate columns for one or more <a href="https://github.com/shawnlaffan/biodiverse/wiki/DataStructures#labels">labels</a> (e.g.&nbsp;names such as genus and species) and <a href="https://github.com/shawnlaffan/biodiverse/wiki/DataStructures#groups">groups</a> (e.g.&nbsp;x and y coordinates of a data point). However you can also import data from raster, <a href="https://biodiverse-analysis-software.blogspot.com/2018/12/import-polygon-and-polyline-data.html">shapefile</a> and <a href="https://biodiverse-analysis-software.blogspot.com/2015/06/import-your-species-data-from.html">spreadsheet</a> formats. All formats except raster can also represent a matrix of data such as for a sites by species matrix (see <a href="https://github.com/shawnlaffan/biodiverse/wiki/SampleSession#data-are-in-matrix-format">Importing Data in Matrix Format</a>).</p>
<p>See the <em>Example_site_data.csv</em> file in the data folder for an example of the file format. The columns of data can be separated by commas, spaces, tabs, semicolons or some other user defined character. There is no restriction on column names or how many columns there are in the file but it is up to the user to know what they represent. You can allow the system to determine the separator type or select from a range of options.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>num</th>
<th>genus</th>
<th>species</th>
<th>x</th>
<th>y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Genus</td>
<td>sp1</td>
<td>3229628</td>
<td>3078198</td>
</tr>
<tr class="even">
<td>2</td>
<td>Genus</td>
<td>sp1</td>
<td>3216986</td>
<td>2951192</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Genus</td>
<td>sp1</td>
<td>3216038</td>
<td>2960749</td>
</tr>
<tr class="even">
<td>4</td>
<td>Genus</td>
<td>sp2</td>
<td>3217265</td>
<td>2960874</td>
</tr>
</tbody>
</table>
<p>Select the import button ![][image6] on the BaseData toolbar (or use menu <em>Basedata&gt;Import</em>) to open the <em>Import Data</em> dialogue window, from where you can select the input data file.</p>
<p>![][image7]</p>
<p>The text box at the top right of the <em>Import Data</em> window allows you to name the output BaseData object that will be produced. Once you are finished, click <strong><em>Next</em></strong>.</p>
<p>![][image8]</p>
<p>You will then see the Import Options window with various options you can set for the import:</p>
<p>![][image9]</p>
<p>Details of all the import options are described in <a href="https://github.com/shawnlaffan/biodiverse/wiki/SampleSession#importing-data">Import Options</a>, but leave all of them unchecked for this tutorial, except ‘<em>Skip lines with undef groups</em>’. Checking this option allows you to ignore records where a group field is either undefined or non-numeric. Such records can occur where you do not know the coordinates for a sample, if you choose the wrong column to use for the groups, or if you have a series of lines with no data at the end of a file.</p>
<p>If you are not importing the <em>Example_site_data.csv</em> file, bear in mind you might need to check some of the other import options. A useful option is ‘<em>Allow empty groups</em>’ which lets you have groups that are considered for analysis, but that have no labels themselves. This is useful when you wish to have moving window analyses extend beyond the sampled data to give a smoother result.</p>
<p>Click <strong><em>Next</em>.</strong></p>
<p>The <em>Choose columns</em> dialog box appears and allows you to select various options for each column in your input text file.</p>
<p>![][image10]</p>
<p>You must set a <em>Type</em> value for at least one Group and one Label column, but more than one of each may be chosen.</p>
<p>All columns in your file that are irrelevant to the analysis should be set to <em>Ignore</em>, as is done for the <strong>num</strong> column in this case.</p>
<p>Select <em>Label</em> as the <em>Type</em> for the <strong>genus</strong> and <strong>species</strong> columns. This represents genus and species values for each record as one combined label, i.e.&nbsp;‘<em>Genus species</em>’.</p>
<p>Select <em>Group</em> as the <em>Type</em> for the <strong>X</strong> and <strong>Y</strong> columns.</p>
<p>When a Group column has been set you will be given the option to select its cell size (in the same units as the group data is stored) and its origin. If you are not importing the <em>Example_site_data.csv</em> file, make sure these dimensions and units are appropriate to your data. You can specify if the group data are degrees using the <em>Data in degrees?</em> comboboxes. This allows you to import data in degrees minutes seconds (e.g.&nbsp;22° 15’ 10’’ S) and decimal degrees formats, as well as enabling some validation that the coordinate values are in the correct range for such units.</p>
<p>The Re-order Columns dialog box is the next window to appear. This allows you to order your labels and groups. For example, placing “y” above “x” makes the y column data the first dimension of a group’s coordinates and x the second (useful if latitude precedes longitude in the column order of your input file). If you forget this step then the axis order can be changed later on using the <em>Duplicate with re-ordered axes</em> tool under the BaseData menu.</p>
<p>Since the columns in <em>Example_site_data.csv</em> are already in the correct order, we will accept the current column ordering. Click <strong><em>OK</em></strong>.</p>
<p>![][image11]</p>
<p>Biodiverse now imports the data from the Example_site_data.csv input file and creates a new BaseData object. Once the import process is complete, the name of the new BaseData object (‘My_new_basedata’ in this case) appears in the top-left of the Biodiverse main window.</p>
<section id="section" class="level4" data-number="5.3.1.1">
<h4 data-number="5.3.1.1" class="anchored" data-anchor-id="section"><span class="header-section-number">5.3.1.1</span> </h4>
</section>
<section id="3.3.1.1-remap" class="level4" data-number="5.3.1.2">
<h4 data-number="5.3.1.2" class="anchored" data-anchor-id="3.3.1.1-remap"><span class="header-section-number">5.3.1.2</span> <strong>3.3.1.1 Remap</strong></h4>
<p>The option to remap label names will appear after the re-order option.</p>
<p>The remap process can generate possible matches between spatial data and any tree, matrices, group properties and label properties automatically. While this section is focused on importing BaseData, any object can have its element names remapped during or after import, with the latter accessed through the Basedata, Tree and Matrix menus as appropriate. The centralised interface for automatic remaps can be accessed under the file menu, as below. There are panes listing exact matches, non-matches (i.e.&nbsp;differences were too great), punctuation matches and possible typos. Users can choose to ignore any of these sets, and also select subsets within the sets if, for example, there are false matches. See the <a href="https://biodiverse-analysis-software.blogspot.com/2017/04/matching-spatial-tree-matrix-and.html">blog for further remap information and examples</a>.</p>
<p>Since we are just importing example base data we will not remap so choose “no”.![][image12]</p>
<p>Having imported data into a BaseData object, you are now ready to run cluster, moving window and randomisation analyses, or you can <strong>visualise</strong> this data (see <a href="#heading=h.4i7ojhp">Visualising Data</a>) or calculate a <strong>spatial index</strong> (see <a href="#heading=h.3as4poj">Building a Spatial Index</a>) which helps run faster analyses when using this BaseData. Alternatively, you can now import additional data files (see importing <a href="#3.3.2-matrices">Matrices</a> and <a href="#heading=h.1y810tw">Trees</a> below).</p>
<p>However, prior to doing anything else, it is a good idea to <strong>Save</strong> your newly imported data. Use the <em>File &gt; Save</em> menu option to save the whole project. To save just the BaseData select the My_new_basedata object, and save it as a BaseData object, either via the <em>Basedata</em> menu (<em>Basedata</em> &gt; <em>Save as</em>) or the ![][image13] icon on the Basedata toolbar.</p>
</section>
</section>
<section id="3.3.2-matrices" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="3.3.2-matrices"><span class="header-section-number">5.3.2</span> <strong>3.3.2 Matrices</strong></h3>
<p>Matrix data can be imported at any time, although it can only be viewed with an existing (and selected) BaseData object. Currently only delimited text files can be imported (e.g.&nbsp;csv or txt files).</p>
<p>Remember that these matrices are not site by species matrices. These are matrices of numeric values representing some relationship between pairs of labels or groups, for example numbers of base pairs shared between pairs of labels. Site by species data are imported using the basedata import process.</p>
<p>Select the import button ![][image6] on the Matrix toolbar to open the Import Matrix dialogue window, from where you can select the input data file. Select <em>Example_matrix.txt</em>, give the new Matrix a name if you like, and click <strong><em>OK</em></strong>.</p>
<p>![][image14]</p>
<p>After deciding if your matrix input file format is normal or sparse, you must now decide how the columns in the matrix file should be read. You must select at least one label column, and <strong>only one</strong> “<em>Matrix start</em>” column. Any other columns in the file should be set to “<em>Ignore</em>”.</p>
<p>![][image15]</p>
<p>Click Ok, then select No when prompted to <em>Remap element names and set include/exclude?</em> The matrix is imported and appears in the drop-down menu in the matrix toolbar at the top of the screen.</p>
<p>The matrix can only be visualised once a BaseData object has been imported and visualised as well. (it will only produce a useful display if the matrix and BaseData share at least some labels).![][image16]</p>
<p>Note that you can either save the matrix as a Matrix <em>.bms</em> object (‘<em>Matrices &gt; Save as</em>’ from the menu), or it can be saved as part of a Project see <a href="6-export.html#6.1-saving-a-project">Saving a Project</a> at the end of this guide.</p>
</section>
<section id="section-1" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="section-1"><span class="header-section-number">5.3.3</span> </h3>
</section>
<section id="3.3.3-trees" class="level3" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="3.3.3-trees"><span class="header-section-number">5.3.4</span> <strong>3.3.3 Trees</strong></h3>
<p>There are two options for creating Trees in Biodiverse:</p>
<ol type="1">
<li><p>Import a Tree into a project at any time</p></li>
<li><p>Derive a Tree at any time if you already have a BaseData and/or matrix object selected.</p></li>
</ol>
<p>In both cases, a Tree can only be visualised with an existing BaseData object. A Tree is most useful if it shares some labels with the BaseData being displayed.</p>
<p><strong>Importing a Tree</strong><br>
A Tree can be imported from nexus (*.nex or *.tre), newick, “R json” or tabular formats. Once a tree is imported, it will be added to the project.<br>
To import a Tree, select the import button ![][image6] on the Tree toolbar. A window will appear asking if your tree data are in a tabular format. After selecting YES or NO, you can select your file:</p>
<p>![][image17]</p>
<p>Select your file and click <strong><em>OK</em></strong>. You will then have the option of choosing a label remap file. This is often needed so the node names match the relevant BaseData labels (see FAQ page: <a href="https://github.com/shawnlaffan/biodiverse/wiki/FAQ#my-phylogenetic-analyses-have-empty-results">My phylogenetic analyses have empty results</a>). In many cases a phylogenetic tree will have labels like “genus_species”, but if you imported data from a file that has genus and species in separate columns then the labels will look like “genus:species”, which will not match. This is where remapping is needed.</p>
<p>![][image18]</p>
<p>Since we are using the example input data, we will remap (but if you don’t wish to remap labels, simply click <strong><em>Cancel</em></strong> and the system will import the tree).</p>
<p>To remap the tree labels using an existing file, click <strong><em>YES</em></strong>. You are prompted to select a remap “label Source”. Here we use “user derived file” to select our <em>Example_tree_remap.txt</em> file. Click <strong><em>OK</em></strong>, accept the column separator and quote defaults, click <strong><em>Next</em></strong>.</p>
<p>![][image19]</p>
<p>A popup dialog now prompts you to specify the column types for the remap process. Specify as many <em>input_element</em> columns as the tree labels have (i.e.&nbsp;one for nexus files) and then each label column in the BaseData object must be designated as a <em>remapped_element</em>. Click <strong><em>OK</em></strong>. The system will import the tree and perform the remapping.</p>
<p>![][image20]</p>
<p><strong>Deriving a Tree</strong><br>
You can derive a Tree from a BaseData object or Matrix at any time. Select the “<em>Create tree from labels</em>” or “<em>Convert matrix to tree</em>” options under the BaseData and Matrix menus, respectively:</p>
<table class="caption-top">
<tbody>
</tbody>
</table>
<p>When generating a tree from the BaseData labels, labels are treated as taxonomic names, and thus are useful if the labels have at least two components (e.g.&nbsp;genus and species). A tree generated from a matrix is simply a cluster analysis using the average linkage function, so will only be valid for dissimilarity matrices.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./2-starting.html" class="pagination-link" aria-label="Starting Biodiverse">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Starting Biodiverse</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./4-visualise.html" class="pagination-link" aria-label="Visualising">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Visualising</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>